Установка LineageOS 19.1 на Xiaomi Mi 10T с помощью TWRP
========================================================

Введение
--------

LineageOS - это свободная операционная система, собираемая на базе операционной системы Android Open Source Project или сокращённо - AOSP).

Известная всем операционная система Android на самом деле собирается на базе той же самой операционной системы AOSP, но отличается наличием сервисов Google. Производители устройств могут собрать собственную операционную систему на базе AOSP, но добавить в неё сервисы Google и назвать свою операционную систему именем Android могут лишь в том случае, если заплатят Google. Кроме сервисов Google производители устройств обычно предустанавливают на устройство собственные программы.

В LineageOS нет сервисов Google и нет программ, предустановленных производителем устройства, что я считаю преимуществом. Я не желаю привязываться к экосистеме Google и предоставлять Google и производителю устройства возможность собирать обо мне информацию. Конечно, это не означает, что какие-либо другие программы не занимаются слежкой, но лучше предпринять какие-то минимальные усилия, чем не делать вообще ничего и сдаться на милость корпорациям.

LineageOS можно установить не на любое устройство. Список поддерживаемых устройств можно найти на странице [LineageOS Wiki - Devices](https://wiki.lineageos.org/devices/). Из всего многообразия я уже пробовал устанавливать LineageOS на [LeEco Le 2](https://wiki.lineageos.org/devices/s2/) и на [Motorola Moto G7](https://wiki.lineageos.org/devices/river/). На этот раз я остановил свой выбор на [Xiaomi Mi 10T](https://wiki.lineageos.org/devices/apollon/). Стоит отметить, что под одной и той же моделью могут продаваться устройства с разной начинкой. Перед покупкой следует уточнить модели устройства и проверить, поддерживается ли эта модель LineageOS. В случае с Xiaomi Mi 10T я заранее убедился, что покупаемое мной устройство с кодом M2007J3SY точно поддерживается LineageOS.

Подготовка устройства
---------------------

Перед прошивкой LineageOS необходимо разблокировать загрузчик устройства. Как это сделать, описано в статье [[Разблокировка загрузчика Xiaomi|xiaomi_bootloader_unlock]].

На моём телефоне была предустановлена операционная система MIUI 12 на базе Android 10. Но LineageOS версии 19.1, которую я хочу установить, основана на Android 12. Часть функциональности устройства обеспечивается программным обеспечением устройства, установленным на устройство его производителем, так называемым Firmware. Чтобы избежать проблем при работе LineageOS 19.1 на устройстве, нужно обновить Firmware. Для нужно установить на телефон MIUI 13 на базе Android 12. Как это сделать, описано в статье [[Обновление операционной системы MIUI на Xiaomi Mi 10T|xiaomi_mi_10t_miui_upgrade]].

Для установки операционной системы используется инструмент восстановления. Можно установить инструмент восстановления LineageOS Recovery, идущий в комплекте с операционной системой LineageOS, а можно воспользоваться более продвинутым инструментом восстановления TWRP, как поступил я. Процедура установки TWRP описана в статье [[Прошивка TWRP на Xiaomi Mi 10T|xiaomi_mi_10t_twrp]].

Прошивка LineageOS
------------------

Для прошивки обновления нам понадобится персональный компьютер и USB-кабель. Подсоединяем устройство к компьютеру с помощью USB-кабеля и переводим устройство в режим восстановления. Для этого выключаем устройство, после чего включаем одновременным нажатием кнопки включения и кнопки прибавления громкости.

Я пользуюсь компьютером под управлением операционной системы Debian GNU/Linux, поэтому опишу процедуру проверки применительно к этой системе.

Устанавливаем в систему пакет `adb`:

    # apt-get install adb

Свежий образ операционной системы LineageOS для Xiaomi Mi 10T можно найти на странице [LineageOS Downloads - Builds for apollon](https://download.lineageos.org/apollon). Скачиваем его.

Теперь очищаем данные, имеющиеся на устройстве, для чего нажимаем на кнопку "Wipe" в TWRP, затем нажимаем на кнопку "Format data" и набираем текст "yes" на экранной клавиатуре. После выполнения очистки возвращаемся в начальное меню.

Теперь приступаем непосредственно к прошивке операционной системы. Нажимаем на кнопку "Advanced" в TWRP, отмечаем галочки "Wipe Dalvik Cache" и "Wipe Cache". Для подтверждения действия проводим пальцем по полоске внизу слева направо.

Переходим к компьютеру, к которому подключен телефон и вводим на нём команду для отправки образа операционной системы в TWRP:

    $ adb sideload lineage-19.1-20221008-nightly-apollon-signed.zip

Наблюдаем за процессом прошивки, после чего перезагружаем устройство. Весь процесс перепрошивки зафиксирован на видео:

[[xiaomi_mi_10t_twrp_lineageos.mp4]]

Использованные материалы
------------------------

* [Install LineageOS on apollon - Installing LineageOS from recovery](https://wiki.lineageos.org/devices/apollon/install#installing-lineageos-from-recovery)
